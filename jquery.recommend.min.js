/*!
 * jQuery Recommend Plugin v2.0.0
 * https://github.com/blakerohde/jquery-recommend-plugin
 * 
 * Copyright 2012, Blake Rohde
 * Dual licensed under the MIT or GPL Version 2 licenses:
 * http://www.opensource.org/licenses/mit-license.php
 * http://www.opensource.org/licenses/GPL-2.0
 */
(function(c,b,a,e){var d=(function(){return{init:function(g,h){var f=this;f.$this=h;f.options=c.extend({},c.fn.recommend.options,g);return f},logger:function(g){var f=this;if(f.options.debug){return f.options.logger(g)}},getCookieContents:function(){var f=this;var g=f.options.cookie.processor(f.options.cookie.name);if(g==null){return""}else{return g}},getCookieIDs:function(){var f=this;var g=f.getCookieContents();if(g==""){return[]}else{return f.getCookieContents().split(f.options.id_seperator)}},getID:function(){var f=this;return c(f.$this).attr("href").substr(f.options.href_id_prefix.length)},deactivate:function(){var f=this;f.logger(f.getCookieIDs().indexOf(f.getID()));if(f.getCookieIDs().indexOf(f.getID())!=-1){f.logger("deactivate "+f.getID());c('[class~="'+f.options.classes.rlabel+'"]',f.$this).replaceWith(f.options.replace_label);var g=c(a.createElement("span")).append(c(f.$this).html());c(f.$this).replaceWith(g);return f.$this=g}return f.$this},getRequestURL:function(){var f=this;if(f.options.request.type){return f.options.request.path+"?type="+f.options.request.type+"&id="+f.getID()}else{return f.options.request.path+"?id="+f.getID()}},appendID:function(g){var f=this;f.logger(f.getCookieIDs());f.logger((f.getCookieIDs().concat([g])).join(f.options.id_seperator));f.options.cookie.processor(f.options.cookie.name,(f.getCookieIDs().concat([g])).join(f.options.id_seperator),{expires:2555,path:"/"})},replace:function(g){var f=this;c('[class~="'+f.options.classes.rnum+'"]',f.$this).hide().html(g).fadeIn("slow");c('[class~="'+f.options.classes.rlabel+'"]',f.$this).replaceWith(f.options.replace_label)},register:function(){var f=this;f.logger(f.$this);if(c(f.$this).attr("href")!=e){c(f.$this).click(function(){f.logger("click "+f.getID());c.ajax({dataType:"json",error:function(){f.logger("AJAX Error")},success:function(g){f.logger(g);f.appendID(g.id);f.deactivate();f.replace(g.count);c(f.$this).off("click")},url:f.getRequestURL()});return false})}return f}}})();c.fn.recommend=function(f){return this.each(function(){var g=c.extend({},d);g.init(f,this);g.deactivate();g.register();c.data(this,"recommend",g)})};c.fn.recommend.options={cookie:{name:"recommended",processor:c.cookie},classes:{rlabel:"rlabel",rnum:"rnum"},debug:false,href_id_prefix:"#recommend-",id_seperator:"-",logger:function(f){console.log(f)},replace_label:"Recommended",request:{path:"",type:""}}})(jQuery,window,document);